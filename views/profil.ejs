<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>
<%- include('./layout/header.ejs') %>
<div class="container mt-5">
  <div class="row">
    <div class="col-md-4">
      <img src=<%= user.avatar  %> alt="Profile Image" style="width:200px" class="img-fluid rounded-circle" id='avatar'>
    </div>
    <div class="col-md-8">
      <h2><%= user.username %></h2>
      <p>Email: <%= user.email %></p>
      <p>Name : <%= user.name %></p>
      <div class="d-flex">
        <a style="margin-right: 40px;" href="/edit/user">Edit</a>
        <form action="/api/logout/">
          <button class="btn btn-primary">Logout</button>
        </form>
      </div>
    </div>
  </div>
  <hr>
  <hr>
  <hr>
  <hr>
  <br>
  <br>
  <h3>Data yang telah dipublish:</h3>
  <div class="mt-4 d-flex">
    <% products.forEach(el=> { %>
        <div class="card" style="width: 18rem; margin-left: 10px;" id='gambar'>
            <span name=<%= el.name %>>  
                <img  style="width:100%;height:200px;" src=<%= el.url %> alt=<% el.pictures %>>
                <div class="card-body">
                  <h5 class="card-title"><%= el.name %></h5>
                  <p class="card-text">Rp.<%= el.price %></p>
                  <a href="/edit/<%= el.id %>" style="color:black;text-decoration: none;">Edit</a>
                  <button onclick=<%='del(' +el.id+')' %> class="btn text-bg-dark" style="margin-left: 5px;">Delete</a>
                </div>
              </div>
            </span>
      <% }) %>
  </div>
  <div class="mt-4">
    <h3>Tambah Produk Baru untuk Dipublish:</h3>
    <button onclick="tambah()" class="btn btn-primary">Tambah data</button>
  </div>
</div>
<%- include('./layout/footer.ejs') %>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>    
      function tambah(){
        window.location = '/tambah';
      }

      let del = (id) => {
      axios.delete('/api/product/' + id).then((result) => {
        alert('Hapus produk berhasil')
        location.reload();
      }).catch((err) => {
        alert('error ' + err)
      });
    }
    
</script>
</body>
</html>